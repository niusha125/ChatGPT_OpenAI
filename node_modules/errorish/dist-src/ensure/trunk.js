import stringify from "./stringify.js";
export default function trunk(error, options, data) {
  if (error instanceof options.Error) return error;
  let message = error && typeof error === 'object' && error.hasOwnProperty('message') ? error.message : error;
  message = options.allow.includes(typeof message) ? stringify(message, options) : options.message;
  error = new options.Errorish(message, error, data);

  if (options.capture && Error.captureStackTrace) {
    Error.captureStackTrace(error, options.Errorish);
  }

  return error;
}